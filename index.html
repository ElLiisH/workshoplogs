<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Login | Digitized ICT Logbook</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

  <style>
    :root {
      --bg-color: #f8fafc; --text-color: #0f172a; --card-bg: #ffffff;
      --border-color: #e2e8f0; --primary-color: #4f46e5; --text-muted: #64748b;
      --input-bg: #ffffff;
    }
    :root.dark {
      --bg-color: #0f172a; --text-color: #f1f5f9; --card-bg: #1e293b;
      --border-color: #334155; --text-muted: #94a3b8; --input-bg: #0f172a;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Inter', sans-serif; background-color: var(--bg-color); color: var(--text-color);
      display: flex; align-items: center; justify-content: center; min-height: 100vh; transition: 0.3s;
    }

    .login-card {
      background: var(--card-bg); padding: 2.5rem; border-radius: 16px; border: 1px solid var(--border-color);
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1); text-align: center; width: 100%; max-width: 400px;
    }

    .brand-logo {
      width: 50px; height: 50px; background: var(--primary-color); color: white; border-radius: 10px;
      display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 20px; margin: 0 auto 1.5rem;
    }

    .form-group { text-align: left; margin-bottom: 1.25rem; }
    label { display: block; font-size: 13px; font-weight: 600; margin-bottom: 6px; }

    .input-wrapper { position: relative; }
    .input-wrapper i { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-muted); font-size: 14px; }

    input {
      width: 100%; padding: 12px 12px 12px 40px; border-radius: 8px; border: 1px solid var(--border-color);
      background: var(--input-bg); color: inherit; font-family: inherit; transition: 0.2s;
    }

    .btn-login {
      width: 100%; background: var(--primary-color); color: white; padding: 12px; border-radius: 8px;
      border: none; font-weight: 600; font-size: 16px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px;
    }
    .btn-login:disabled { opacity: 0.7; cursor: not-allowed; }

    .spinner {
      width: 20px; height: 20px; border: 3px solid rgba(255, 255, 255, 0.3); border-top-color: #fff;
      border-radius: 50%; animation: spin 0.8s linear infinite; display: none;
    }

    @keyframes spin { to { transform: rotate(360deg); } }
    .theme-switcher { position: fixed; top: 20px; right: 20px; }
    .btn-circle { width: 40px; height: 40px; border-radius: 50%; border: 1px solid var(--border-color); background: var(--card-bg); color: var(--text-color); cursor: pointer; }
  </style>
</head>
<body>

<div class="theme-switcher">
  <button id="themeToggle" class="btn-circle"><i class="fa-solid fa-moon"></i></button>
</div>

<div class="login-card">
  <div class="brand-logo">ICT</div>
  <h1 style="font-size: 24px; margin-bottom: 0.5rem;">ICT Workshop Portal</h1>
  <p style="color: var(--text-muted); font-size: 14px; margin-bottom: 2rem;">Authorized Personnel Only</p>

  <form id="loginForm">
    <div class="form-group">
      <label>Technician ID</label>
      <div class="input-wrapper">
        <i class="fa-solid fa-user-shield"></i>
        <input type="text" id="username" placeholder="Enter Admin or Tech ID" required>
      </div>
    </div>

    <div class="form-group">
      <label>Access Key</label>
      <div class="input-wrapper">
        <i class="fa-solid fa-key"></i>
        <input type="password" id="password" placeholder="••••••••" required>
      </div>
    </div>

    <button type="submit" id="signInBtn" class="btn-login">
      <span id="btnText">Sign In</span>
      <div id="btnSpinner" class="spinner"></div>
    </button>
  </form>

  <p id="statusMsg" style="margin-top: 1.5rem; font-size: 12px; color: var(--primary-color); font-weight: 600; height: 18px;"></p>
</div>

<script>
  // Theme Management
  const applyTheme = () => {
    const mode = localStorage.getItem("theme") || "light";
    document.documentElement.classList.toggle("dark", mode === "dark");
    document.querySelector("#themeToggle i").className = mode === "dark" ? "fa-solid fa-sun" : "fa-solid fa-moon";
  };

  document.getElementById("themeToggle").onclick = () => {
    localStorage.setItem("theme", (localStorage.getItem("theme") || "light") === "light" ? "dark" : "light");
    applyTheme();
  };

  // ROLE-BASED LOGIN LOGIC
  document.getElementById("loginForm").onsubmit = function(e) {
    e.preventDefault();

    const userInp = document.getElementById("username").value;
    const btn = document.getElementById("signInBtn");
    const btnText = document.getElementById("btnText");
    const spinner = document.getElementById("btnSpinner");
    const statusMsg = document.getElementById("statusMsg");

    // 1. Loading State
    btn.disabled = true;
    btnText.textContent = "Authenticating...";
    spinner.style.display = "block";
    statusMsg.textContent = "Handshaking with ICT Mainframe...";

    // 2. Technician Registry (Map IDs to Names)
    const techMap = {
      "TECH001": "John Doe",
      "TECH002": "James Smith",
      "TECH003": "Sarah Connor",
      "TECH004": "Robert Brown",
      "TECH005": "Emily Davis"
    };

    // 3. Identification Logic
    let role = "Guest";
    let displayName = userInp;

    if (userInp.toLowerCase() === "admin") {
      role = "Admin";
      displayName = "System Administrator";
    } else if (techMap[userInp.toUpperCase()]) {
      role = "Technician";
      displayName = techMap[userInp.toUpperCase()];
    } else {
      // Logic for invalid user
      setTimeout(() => {
        btn.disabled = false;
        btnText.textContent = "Sign In";
        spinner.style.display = "none";
        statusMsg.textContent = "Error: Unauthorized ID.";
        statusMsg.style.color = "#ef4444";
      }, 1500);
      return;
    }

    // 4. Save Session Data locally for workshoplocal.html to read
    sessionStorage.setItem("currentUser", displayName);
    sessionStorage.setItem("userRole", role);

    // 5. Simulated Delay
    const delay = Math.floor(Math.random() * 2000) + 2000;
    setTimeout(() => {
      statusMsg.textContent = "Access Granted. Initializing " + role + " Profile...";
      statusMsg.style.color = "#10b981";
      
      setTimeout(() => {
        window.location.href = "workshoplocal.html";
      }, 1000);
    }, delay);
  };

  applyTheme();
</script>

</body>
</html>
